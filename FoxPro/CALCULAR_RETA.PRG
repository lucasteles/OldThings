PARAMETERS tcOPC,tnX1,tnY1,tnX2,tnY2,tnXVER,tnYVER

tcOPC = STRTRAN(UPPER(tcOPC),' ','')

IF tcOPC == 'EQUAÇÃODARETA'
	DO EQUACAORETA
	RETURN
ENDIF

IF tcOPC == 'MEDIATRIZ'
	DO MEDIA WITH 'MEDIATRIZ'
	RETURN
ENDIF

IF tcOPC == 'MEDIANA'
	DO MEDIA WITH 'MEDIANA'
	RETURN
ENDIF

PROC EQUACAORETA
****************
	LOCAL lnANGULAR,lnLINEAR AS Number
	LOCAL lcEQUACAO AS String

	IF VARTYPE(tnY2)<>'N'
		lnANGULAR = tnX2
	ELSE
		lnANGULAR = (tnY2-tnY1)/(tnX2-tnX1)
	ENDIF

	lnLINEAR = tnY1 - (lnANGULAR*tnX1)

	lcEQUACAO = 'y='+TRANSFORM(lnANGULAR)+'x'+IIF(lnLINEAR>0,'+'+TRANSFORM(lnLINEAR),TRANSFORM(lnLINEAR))

	TEXT TO lcMSG NOSHOW TEXTMERGE PRETEXT 7
		Coeficiente angular é <<TRANSFORM(lnANGULAR)>>
		Coeficiente linear é <<TRANSFORM(lnLINEAR)>>
		A equação da reta é <<lcEQUACAO>>
	ENDTEXT

	MESSAGEBOX(lcMSG)
ENDPROC

PROC MEDIA
**************
LPARAMETERS tcTIPO
	LOCAL lnX,lnY,lnMEDIANA as Number

	lnX = (tnX1+tnX2)/2

	lnY = (tnY1+tnY2)/2
	
	IF tcTIPO == 'MEDIATRIZ'
		TEXT TO lcMSG NOSHOW TEXTMERGE PRETEXT 7
			O ponto medío é M(<<TRANSFORM(lnX)>>,<<TRANSFORM(lnY)>>)
		ENDTEXT
		
		MESSAGEBOX(lcMSG)
		RETURN(.T.)
	ENDIF

	lnMEDIANA = (lnX - tnXVER)^2 + (lnY - tnYVER)^2
	IF tcTIPO == 'MEDIANA'
		TEXT TO lcMSG NOSHOW TEXTMERGE PRETEXT 7
			A mediana é <<lnMEDIANA>>
		ENDTEXT
		
		MESSAGEBOX(lcMSG)
		RETURN(.T.)
	ENDIF
ENDPROC
