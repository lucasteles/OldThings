DECLARE INTEGER FindWindow IN "user32" STRING, STRING
DECLARE INTEGER GetWindowLong IN "user32" INTEGER, INTEGER
DECLARE INTEGER SetWindowLong IN "user32" INTEGER, INTEGER, INTEGER
DECLARE INTEGER SetLayeredWindowAttributes IN "user32" INTEGER, INTEGER, INTEGER, INTEGER
LOCAL lnTRANS AS INTEGER
lnTRANS=0


DO windowsierarq

SELE CS
GO TOP
DELETE FOR EMPTY(ALLTRIM(wintitle))
SELE CS
GO TOP

FOR lnXI = 1 TO 3
	FOR lnTRANS= 0 TO 95
		TRANSP(lnTRANS)
	ENDFOR
	FOR lnTRANS= 95 TO 0 STEP -1
		TRANSP(lnTRANS)
	ENDFOR
ENDFOR 


FUNC TRANSP(tnNIVEL)
	LOCAL LNLEVEL, LNOLDSTYLE, LNWNDSHELL_TRAYWND
	LNLEVEL = 255-MAX(0, MIN(INT(tnNIVEL*255/100), 255))
	SELE CS
	GO TOP
	SCAN WHILE NOT EOF()
		LNHWNDSHELL_TRAYWND =CS.winhandle 
		IF LNHWNDSHELL_TRAYWND<>0
			LNOLDSTYLE = GETWINDOWLONG(LNHWNDSHELL_TRAYWND, -20)
			SETWINDOWLONG(LNHWNDSHELL_TRAYWND, -20, BITOR(LNOLDSTYLE, 524288))
			SETLAYEREDWINDOWATTRIBUTES(LNHWNDSHELL_TRAYWND, 0, LNLEVEL, 02)
		ENDIF
	ENDSCAN