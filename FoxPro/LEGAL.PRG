LPARAMETERS tnNIVEL

IF VARTYPE(TNNIVEL) # 'N'
	TNNIVEL=0
ENDIF


DECLARE INTEGER FindWindow IN "user32" STRING, STRING
DECLARE INTEGER GetWindowLong IN "user32" INTEGER, INTEGER
DECLARE INTEGER SetWindowLong IN "user32" INTEGER, INTEGER, INTEGER
DECLARE INTEGER SetLayeredWindowAttributes IN "user32" INTEGER, INTEGER, INTEGER, INTEGER

LOCAL LNLEVEL, LNOLDSTYLE, LNWNDSHELL_TRAYWND
LNLEVEL = 255-MAX(0, MIN(INT(tnNIVEL*255/100), 255))
LNHWNDSHELL_TRAYWND = FINDWINDOW("Shell_TrayWnd", 0)
IF LNHWNDSHELL_TRAYWND<>0
	LNOLDSTYLE = GETWINDOWLONG(LNHWNDSHELL_TRAYWND, -20)
	SETWINDOWLONG(LNHWNDSHELL_TRAYWND, -20, BITOR(LNOLDSTYLE, 524288))
	SETLAYEREDWINDOWATTRIBUTES(LNHWNDSHELL_TRAYWND, 0, LNLEVEL, 02)
ENDIF